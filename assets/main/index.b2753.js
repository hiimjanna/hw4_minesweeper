window.__require=function e(t,o,n){function r(c,p){if(!o[c]){if(!t[c]){var a=c.split("/");if(a=a[a.length-1],!t[a]){var s="function"==typeof __require&&__require;if(!p&&s)return s(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+c+"'")}c=a}var u=o[c]={exports:{}};t[c][0].call(u.exports,function(e){return r(t[c][1][e]||e)},u,u.exports,e,t,o,n)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<n.length;c++)r(n[c]);return r}({game:[function(e,t,o){"use strict";cc._RF.push(t,"5cd7cpzAg5KELjsq7oEawXH","game");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,c=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var p=e.length-1;p>=0;p--)(r=e[p])&&(c=(i<3?r(c):i>3?r(t,o,c):r(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,p=i.property,a=e("./number"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.connectUI=null,t.button_url=null,t.editBox_url=null,t.prefab=null,t.view=null,t.playerColor=[],t.ws=null,t.gameOver=null,t.menu=null,t.history=null,t.players=null,t.index=null,t.Gindex=null,t.leader=null,t.server_url=null,t}return n(t,e),t.prototype.onLoad=function(){this.connectUI.y=0,this.button_url.node.on("click",this.link,this)},t.prototype.link=function(){var e=this;this.server_url=this.editBox_url.string,this.connectUI.y=1e3,this.ws=new WebSocket("wss://"+this.server_url),this.schedule(function(){e.ws.readyState===WebSocket.OPEN&&e.game_start()},1,0,0)},t.prototype.game_start=function(){var e=this;this.ws.send(JSON.stringify({Type:"get.board"})),this.ws.send(JSON.stringify({Type:"get.players"})),this.ws.onmessage=function(t){var o=JSON.parse(t.data);if(o.Client){e.index=o.GID;for(var n=0;n<4096;n++){var r=+o.Client[n];e.view.children[n].getComponent(a.default).num!=r&&(e.view.children[n].getComponent(a.default).num=r),-1!=r&&e.view.children[n].getComponent(a.default).up()}}else if(o[0])if(o[0].hasOwnProperty("GID")){if(e.history.string="(Last Game)\n",e.index){o[e.index-1].Players.sort(function(e,t){return t.Score-e.Score});for(var i=0;i<5;i++)e.history.string+=o[e.index-1].Players[i].Name+"\t\t",e.history.string+=o[e.index-1].Players[i].Score+"\n"}e.history.node.parent.active=!e.history.node.parent.active,e.players.node.parent.active&&(e.players.node.parent.active=!1)}else{e.players.string="(Alive Player)\n";for(i=0;i<o.length;i++)o[i].Alive&&(e.players.string+=o[i].Name+"\n");e.leader.string="Leader  Score\n",o.sort(function(e,t){return t.Score-e.Score});var c=Math.min(5,o.length);for(i=0;i<c;i++)e.leader.string+=o[i].Name+"\t\t",e.leader.string+=o[i].Score.toString()+"\n";e.players.node.parent.active=!e.players.node.parent.active,e.history.node.parent.active&&(e.history.node.parent.active=!1)}else o.Score?(e.ws.send(JSON.stringify({Type:"get.board"})),-1==o.Score&&(e.gameOver.active=!0,setTimeout(function(){e.menu.active=!0},1e3))):o.Msg?o.Code?alert("\u5bc6\u78bc\u8f38\u5165\u932f\u8aa4"):cc.director.loadScene("map"):(o.Pid||o.Code&&!o.hasOwnProperty("Score"))&&(0==o.Code?(e.gameOver.active=!1,e.menu.getComponent("menu").hide()):1==o.Code?alert("\u540d\u5b57\u91cd\u8907"):2==o.Code?alert("\u73fe\u5728\u73a9\u5bb6\u5df2\u6eff\u4eba"):3==o.Code?alert("\u904a\u6232\u73a9\u5bb6\u5df2\u6eff\u4eba"):4==o.Code&&alert("\u5df2\u7d93\u5728\u904a\u6232\u4e2d"))}},t.prototype.start=function(){this.menu.active=!0;for(var e=0;e<64;e++){for(var t=0;t<64;t++){var o=cc.instantiate(this.prefab);o.getComponent(a.default).ID=64*e+t,this.view.addChild(o),o.setPosition(cc.v2(50*e-1600+25,50*t-1600+25))}this.playerColor.push(this.randomHexColor())}},t.prototype.randomHexColor=function(){return cc.Color.fromHEX(new cc.Color,"#"+("01010"+(16777216*Math.random()<<0).toString(16)).substr(-6))},t.prototype.update=function(e){},r([p(cc.Node)],t.prototype,"connectUI",void 0),r([p(cc.Button)],t.prototype,"button_url",void 0),r([p(cc.EditBox)],t.prototype,"editBox_url",void 0),r([p(cc.Prefab)],t.prototype,"prefab",void 0),r([p(cc.Node)],t.prototype,"view",void 0),r([p],t.prototype,"playerColor",void 0),r([p],t.prototype,"ws",void 0),r([p(cc.Node)],t.prototype,"gameOver",void 0),r([p(cc.Node)],t.prototype,"menu",void 0),r([p(cc.Label)],t.prototype,"history",void 0),r([p(cc.Label)],t.prototype,"players",void 0),r([p],t.prototype,"index",void 0),r([p(cc.Label)],t.prototype,"Gindex",void 0),r([p(cc.Label)],t.prototype,"leader",void 0),t=r([c],t)}(cc.Component);o.default=s,cc._RF.pop()},{"./number":"number"}],menu:[function(e,t,o){"use strict";cc._RF.push(t,"d28f9Za1lhD8btEpeB7JOBb","menu");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,c=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var p=e.length-1;p>=0;p--)(r=e[p])&&(c=(i<3?r(c):i>3?r(t,o,c):r(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,c=i.ccclass,p=i.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.button=null,t.Name=null,t.password=null,t}return n(t,e),t.prototype.start=function(){},t.prototype.hide=function(){this.button.active=!0,this.node.active=!1},t.prototype.show=function(){this.button.active=!1,this.node.active=!0},t.prototype.play=function(){var e={Type:"action.join",Name:this.Name.string};this.node.parent.getComponent("game").ws.send(JSON.stringify(e))},t.prototype.history=function(){this.node.parent.getComponent("game").ws.send(JSON.stringify({Type:"get.history"}))},t.prototype.alive=function(){this.node.parent.getComponent("game").ws.send(JSON.stringify({Type:"get.players"}))},t.prototype.newGame=function(){var e={Type:"system.nextgame",Name:this.password.string};this.node.parent.getComponent("game").ws.send(JSON.stringify(e))},r([p(cc.Node)],t.prototype,"button",void 0),r([p(cc.EditBox)],t.prototype,"Name",void 0),r([p(cc.EditBox)],t.prototype,"password",void 0),t=r([c],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],number:[function(e,t,o){"use strict";cc._RF.push(t,"32c15HAeR1GtKxl7i+gqYsT","number");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,c=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,n);else for(var p=e.length-1;p>=0;p--)(r=e[p])&&(c=(i<3?r(c):i>3?r(t,o,c):r(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./game"),c=cc._decorator,p=c.ccclass,a=c.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.flag=null,t.num=null,t.ID=0,t.bg=null,t.minepic=null,t.flagpic=null,t.openedpic=null,t.unknowpic=null,t.numberpics=[],t.game=null,t}return n(t,e),t.prototype.onLoad=function(){this.game=cc.find("Canvas/Main Camera").getComponent(i.default),this.node.on(cc.Node.EventType.MOUSE_DOWN,this.onMouseDown,this)},t.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.MOUSE_DOWN,this.onMouseDown,this)},t.prototype.onMouseDown=function(e){var t=e.getButton();t===cc.Event.EventMouse.BUTTON_LEFT?this.click(!1):t===cc.Event.EventMouse.BUTTON_RIGHT&&this.click(!0)},t.prototype.click=function(e){if(this.game.getComponent("game").ws.readyState===WebSocket.OPEN){var t={Type:"action.click",Index:this.ID,Flag:e};this.game.getComponent("game").ws.send(JSON.stringify(t))}},t.prototype.up=function(){var e=this.num%10;9==e?this.flag.active=!0:this.bg.getComponent(cc.Sprite).spriteFrame=e>0?this.numberpics[e-1]:0==e?this.openedpic:this.minepic,this.node.getComponent(cc.Button).normalColor=this.game.getComponent("game").playerColor[Math.floor(this.num/10)],this.node.getComponent(cc.Button).enabled=!1},r([a(cc.Label)],t.prototype,"label",void 0),r([a(cc.Node)],t.prototype,"flag",void 0),r([a],t.prototype,"num",void 0),r([a],t.prototype,"ID",void 0),r([a(cc.Node)],t.prototype,"bg",void 0),r([a(cc.SpriteFrame)],t.prototype,"minepic",void 0),r([a(cc.SpriteFrame)],t.prototype,"flagpic",void 0),r([a(cc.SpriteFrame)],t.prototype,"openedpic",void 0),r([a(cc.SpriteFrame)],t.prototype,"unknowpic",void 0),r([a(cc.SpriteFrame)],t.prototype,"numberpics",void 0),t=r([p],t)}(cc.Component);o.default=s,cc._RF.pop()},{"./game":"game"}]},{},["game","menu","number"]);